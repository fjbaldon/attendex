# ==============================================================
# SERVER CONFIGURATION
# ==============================================================
spring.application.name=platform
server.port=8080

# Enable GZIP compression for JSON responses (faster network transfer)
server.compression.enabled=true
server.compression.mime-types=text/html,text/xml,text/plain,text/css,text/javascript,application/javascript,application/json
server.compression.min-response-size=1024

# ==============================================================
# DATABASE CONFIGURATION (PostgreSQL)
# ==============================================================
# Use Environment Variables for connection details
spring.datasource.url=${DB_URL}
spring.datasource.username=${DB_USERNAME}
spring.datasource.password=${DB_PASSWORD}
spring.datasource.driver-class-name=org.postgresql.Driver

# HikariCP Connection Pooling (Crucial for performance)
# Wait 30s for a connection before failing
spring.datasource.hikari.connection-timeout=30000
# Minimum idle connections to keep ready
spring.datasource.hikari.minimum-idle=5
# Max connections (adjust based on your DB server size, 10-20 is usually enough for small/medium apps)
spring.datasource.hikari.maximum-pool-size=20
# Max lifetime of a connection (recommend 10-30 mins)
spring.datasource.hikari.max-lifetime=1800000

# ==============================================================
# JPA / HIBERNATE
# ==============================================================
# VALIDATE the schema against entities, but do NOT modify the DB. 
# Let Flyway handle migrations.
spring.jpa.hibernate.ddl-auto=validate

# PERFORMANCE: Close DB transactions immediately after Service layer finishes.
# Prevents holding connections open while rendering JSON.
spring.jpa.open-in-view=false

# LOGGING: Disable SQL logging in production to save disk space and CPU.
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=false

# Naming strategy (snake_case in DB, camelCase in Java)
spring.jpa.hibernate.naming.physical-strategy=org.hibernate.boot.model.naming.CamelCaseToUnderscoresNamingStrategy

# ==============================================================
# MIGRATIONS (Flyway)
# ==============================================================
spring.flyway.enabled=true
# Automatically migrate the DB on startup
spring.flyway.baseline-on-migrate=true

# ==============================================================
# SECURITY (JWT)
# ==============================================================
# This must be a long, random string set in your server environment
jwt.secret=${JWT_SECRET}
# 24 Hours (in milliseconds)
jwt.expiration-ms=86400000

# ==============================================================
# MAIL CONFIGURATION
# ==============================================================
spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=${MAIL_USERNAME}
spring.mail.password=${MAIL_PASSWORD}
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true
spring.mail.properties.mail.transport.protocol=smtp
spring.mail.properties.mail.debug=false

# ==============================================================
# APP CUSTOM CONFIG
# ==============================================================
# Used for CORS and generating links in emails
app.frontend.url=${FRONTEND_URL}

# ==============================================================
# LOGGING
# ==============================================================
# Only log INFO and above. Debug is too noisy for production.
logging.level.root=INFO
logging.level.com.github.fjbaldon.attendex=INFO
# Hide Hikari/Hibernate noise
logging.level.com.zaxxer.hikari=WARN
logging.level.org.hibernate=WARN